[Definition]
# Fail2ban filter for QuBot API scanner detection
# Matches vulnerability scanner patterns in uvicorn logs

# Match scanner patterns
failregex = ^INFO:\s+<HOST>:\d+ - "(?:GET|POST|PUT|DELETE|HEAD|OPTIONS) /(?:.*\.(?:php\d?|phtml|htr|htm|shtm|shtml|asp|aspx|cfm|cgi|pl|jsp|jspx)|iisadmpwd|iisadmin|phpmyadmin|wp-admin|wp-login|wp-content|wp-includes|\.env|\.git|\.svn|\.htaccess|administrator|admin\.php|login\.php|setup\.php|config\.php|shell|c99|r57|webshell|eval-stdin|phpunit|xmlrpc|niet)\S* HTTP/\d\.\d" \d+
            ^.*\[Security\].*Scanner detected from <HOST>.*$
            ^.*\[Security\].*Blocked IP: <HOST>.*$

ignoreregex = 

# Uvicorn doesn't include timestamps by default, rely on journal or wrapper
datepattern = ^%%Y-%%m-%%d %%H:%%M:%%S
              {^LN-BEG}
